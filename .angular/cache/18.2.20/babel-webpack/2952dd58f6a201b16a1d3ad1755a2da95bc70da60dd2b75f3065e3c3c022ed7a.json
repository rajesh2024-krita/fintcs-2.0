{"ast":null,"code":"import { Router } from '@angular/router';\nimport { inject } from '@angular/core';\nimport { AuthService } from '../services/auth.service';\nexport const roleGuard = allowedRoles => {\n  return (route, state) => {\n    const authService = inject(AuthService);\n    const router = inject(Router);\n    if (!authService.isAuthenticated()) {\n      router.navigate(['/auth/login']);\n      return false;\n    }\n    if (authService.hasAnyRole(allowedRoles)) {\n      return true;\n    }\n    router.navigate(['/dashboard']);\n    return false;\n  };\n};\nexport const authGuard = (route, state) => {\n  const authService = inject(AuthService);\n  const router = inject(Router);\n  if (authService.isAuthenticated()) {\n    return true;\n  }\n  router.navigate(['/auth/login']);\n  return false;\n};","map":{"version":3,"names":["Router","inject","AuthService","roleGuard","allowedRoles","route","state","authService","router","isAuthenticated","navigate","hasAnyRole","authGuard"],"sources":["/home/runner/workspace/src/app/core/guards/role.guard.ts"],"sourcesContent":["\nimport { CanActivateFn, Router } from '@angular/router';\nimport { inject } from '@angular/core';\nimport { AuthService } from '../services/auth.service';\nimport { UserRole } from '../../shared/models/user.model';\n\nexport const roleGuard = (allowedRoles: UserRole[]): CanActivateFn => {\n  return (route, state) => {\n    const authService = inject(AuthService);\n    const router = inject(Router);\n\n    if (!authService.isAuthenticated()) {\n      router.navigate(['/auth/login']);\n      return false;\n    }\n\n    if (authService.hasAnyRole(allowedRoles)) {\n      return true;\n    }\n\n    router.navigate(['/dashboard']);\n    return false;\n  };\n};\n\nexport const authGuard: CanActivateFn = (route, state) => {\n  const authService = inject(AuthService);\n  const router = inject(Router);\n\n  if (authService.isAuthenticated()) {\n    return true;\n  }\n\n  router.navigate(['/auth/login']);\n  return false;\n};\n"],"mappings":"AACA,SAAwBA,MAAM,QAAQ,iBAAiB;AACvD,SAASC,MAAM,QAAQ,eAAe;AACtC,SAASC,WAAW,QAAQ,0BAA0B;AAGtD,OAAO,MAAMC,SAAS,GAAIC,YAAwB,IAAmB;EACnE,OAAO,CAACC,KAAK,EAAEC,KAAK,KAAI;IACtB,MAAMC,WAAW,GAAGN,MAAM,CAACC,WAAW,CAAC;IACvC,MAAMM,MAAM,GAAGP,MAAM,CAACD,MAAM,CAAC;IAE7B,IAAI,CAACO,WAAW,CAACE,eAAe,EAAE,EAAE;MAClCD,MAAM,CAACE,QAAQ,CAAC,CAAC,aAAa,CAAC,CAAC;MAChC,OAAO,KAAK;IACd;IAEA,IAAIH,WAAW,CAACI,UAAU,CAACP,YAAY,CAAC,EAAE;MACxC,OAAO,IAAI;IACb;IAEAI,MAAM,CAACE,QAAQ,CAAC,CAAC,YAAY,CAAC,CAAC;IAC/B,OAAO,KAAK;EACd,CAAC;AACH,CAAC;AAED,OAAO,MAAME,SAAS,GAAkBA,CAACP,KAAK,EAAEC,KAAK,KAAI;EACvD,MAAMC,WAAW,GAAGN,MAAM,CAACC,WAAW,CAAC;EACvC,MAAMM,MAAM,GAAGP,MAAM,CAACD,MAAM,CAAC;EAE7B,IAAIO,WAAW,CAACE,eAAe,EAAE,EAAE;IACjC,OAAO,IAAI;EACb;EAEAD,MAAM,CAACE,QAAQ,CAAC,CAAC,aAAa,CAAC,CAAC;EAChC,OAAO,KAAK;AACd,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}